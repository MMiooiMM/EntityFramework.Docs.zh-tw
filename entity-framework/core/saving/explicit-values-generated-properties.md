---
title: "產生的內容-EF 核心設定明確的值"
author: rowanmiller
ms.author: divega
ms.date: 10/27/2016
ms.assetid: 3f1993c2-cdf5-425b-bac2-a2665a20322b
ms.technology: entity-framework-core
uid: core/saving/explicit-values-generated-properties
ms.openlocfilehash: f34e92d9a3b10b6ff904257ccd047a8acdaad231
ms.sourcegitcommit: 5e2d97e731f975cf3405ff3deab2a3c75ad1b969
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/15/2017
---
# <a name="setting-explicit-values-for-generated-properties"></a><span data-ttu-id="c77da-102">明確的值設定為產生的屬性</span><span class="sxs-lookup"><span data-stu-id="c77da-102">Setting Explicit Values for Generated Properties</span></span>

<span data-ttu-id="c77da-103">產生的屬性是的屬性 （可由 EF 或資料庫），其值會產生當實體已加入及/或更新。</span><span class="sxs-lookup"><span data-stu-id="c77da-103">A generated property is a property whose value is generated (either by EF or the database) when the entity is added and/or updated.</span></span> <span data-ttu-id="c77da-104">請參閱[產生屬性](../modeling/generated-properties.md)如需詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="c77da-104">See [Generated Properties](../modeling/generated-properties.md) for more information.</span></span>

<span data-ttu-id="c77da-105">可能會有您要設定產生的屬性，而不需要產生的外顯值的情況。</span><span class="sxs-lookup"><span data-stu-id="c77da-105">There may be situations where you want to set an explicit value for a generated property, rather than having one generated.</span></span>

> [!TIP]  
> <span data-ttu-id="c77da-106">您可以檢視這篇文章[範例](https://github.com/aspnet/EntityFramework.Docs/tree/master/samples/core/Saving/Saving/ExplicitValuesGenerateProperties/)GitHub 上。</span><span class="sxs-lookup"><span data-stu-id="c77da-106">You can view this article's [sample](https://github.com/aspnet/EntityFramework.Docs/tree/master/samples/core/Saving/Saving/ExplicitValuesGenerateProperties/) on GitHub.</span></span>

## <a name="the-model"></a><span data-ttu-id="c77da-107">模型</span><span class="sxs-lookup"><span data-stu-id="c77da-107">The model</span></span>

<span data-ttu-id="c77da-108">在本文中使用的模型包含單一`Employee`實體。</span><span class="sxs-lookup"><span data-stu-id="c77da-108">The model used in this article contains a single `Employee` entity.</span></span>

[!code-csharp[Main](../../../samples/core/Saving/Saving/ExplicitValuesGenerateProperties/Employee.cs#Sample)]

## <a name="saving-an-explicit-value-during-add"></a><span data-ttu-id="c77da-109">儲存期間新增明確的值</span><span class="sxs-lookup"><span data-stu-id="c77da-109">Saving an explicit value during add</span></span>

<span data-ttu-id="c77da-110">`Employee.EmploymentStarted`屬性已設定為具有新的實體 （使用預設值） 的資料庫所產生的值。</span><span class="sxs-lookup"><span data-stu-id="c77da-110">The `Employee.EmploymentStarted` property is configured to have values generated by the database for new entities (using a default value).</span></span>

[!code-csharp[Main](../../../samples/core/Saving/Saving/ExplicitValuesGenerateProperties/EmployeeContext.cs#EmploymentStarted)]

<span data-ttu-id="c77da-111">下列程式碼會插入資料庫中的兩個員工。</span><span class="sxs-lookup"><span data-stu-id="c77da-111">The following code inserts two employees into the database.</span></span>
* <span data-ttu-id="c77da-112">第一個，指定任何值給`Employee.EmploymentStarted`屬性，以便維持設定為的 CLR 預設值`DateTime`。</span><span class="sxs-lookup"><span data-stu-id="c77da-112">For the first, no value is assigned to `Employee.EmploymentStarted` property, so it remains set to the CLR default value for `DateTime`.</span></span>
* <span data-ttu-id="c77da-113">秒，我們已設定的明確值`1-Jan-2000`。</span><span class="sxs-lookup"><span data-stu-id="c77da-113">For the second, we have set an explicit value of `1-Jan-2000`.</span></span>

[!code-csharp[Main](../../../samples/core/Saving/Saving/ExplicitValuesGenerateProperties/Sample.cs#EmploymentStarted)]

<span data-ttu-id="c77da-114">輸出顯示資料庫產生值的第一位員工，並使用第二個我們明確的值。</span><span class="sxs-lookup"><span data-stu-id="c77da-114">Output shows that the database generated a value for the first employee and our explicit value was used for the second.</span></span>

``` Console
1: John Doe, 1/26/2017 12:00:00 AM
2: Jane Doe, 1/1/2000 12:00:00 AM
```

### <a name="explicit-values-into-sql-server-identity-columns"></a><span data-ttu-id="c77da-115">明確值插入 SQL Server IDENTITY 資料行</span><span class="sxs-lookup"><span data-stu-id="c77da-115">Explicit values into SQL Server IDENTITY columns</span></span>

<span data-ttu-id="c77da-116">依照慣例`Employee.EmployeeId`屬性是存放區產生`IDENTITY`資料行。</span><span class="sxs-lookup"><span data-stu-id="c77da-116">By convention the `Employee.EmployeeId` property is a store generated `IDENTITY` column.</span></span>

<span data-ttu-id="c77da-117">大部分的情況下，如上所示的方法可用於索引鍵屬性。</span><span class="sxs-lookup"><span data-stu-id="c77da-117">For most situations, the approach shown above will work for key properties.</span></span> <span data-ttu-id="c77da-118">不過，將明確值插入 SQL Server`IDENTITY`資料行中，您必須手動啟用`IDENTITY_INSERT`之前先呼叫`SaveChanges()`。</span><span class="sxs-lookup"><span data-stu-id="c77da-118">However, to insert explicit values into a SQL Server `IDENTITY` column, you need to manually enable `IDENTITY_INSERT` before calling `SaveChanges()`.</span></span>

> [!NOTE]  
> <span data-ttu-id="c77da-119">我們有[功能要求](https://github.com/aspnet/EntityFramework/issues/703)在我們的待辦項目，SQL Server 提供者內自動執行此動作。</span><span class="sxs-lookup"><span data-stu-id="c77da-119">We have a [feature request](https://github.com/aspnet/EntityFramework/issues/703) on our backlog to do this automatically within the SQL Server provider.</span></span>

[!code-csharp[Main](../../../samples/core/Saving/Saving/ExplicitValuesGenerateProperties/Sample.cs#EmployeeId)]

<span data-ttu-id="c77da-120">輸出會顯示所提供的識別碼已儲存至資料庫。</span><span class="sxs-lookup"><span data-stu-id="c77da-120">Output shows that the supplied ids were saved to the database.</span></span>

``` Console
100: John Doe
101: Jane Doe
```

## <a name="setting-an-explicit-value-during-update"></a><span data-ttu-id="c77da-121">更新期間設定明確的值</span><span class="sxs-lookup"><span data-stu-id="c77da-121">Setting an explicit value during update</span></span>

<span data-ttu-id="c77da-122">`Employee.LastPayRaise`屬性已設定為具有由資料庫更新時所產生的值。</span><span class="sxs-lookup"><span data-stu-id="c77da-122">The `Employee.LastPayRaise` property is configured to have values generated by the database during updates.</span></span>

[!code-csharp[Main](../../../samples/core/Saving/Saving/ExplicitValuesGenerateProperties/EmployeeContext.cs#LastPayRaise)]

> [!NOTE]  
> <span data-ttu-id="c77da-123">根據預設，EF Core 將會擲回例外狀況，如果您嘗試儲存屬性設定為在更新期間產生的外顯值。</span><span class="sxs-lookup"><span data-stu-id="c77da-123">By default, EF Core will throw an exception if you try to save an explicit value for a property that is configured to be generated during update.</span></span> <span data-ttu-id="c77da-124">若要避免這個問題，您需要較低層級的中繼資料 API 下拉式清單，然後設定`AfterSaveBehavior`（如上所示）。</span><span class="sxs-lookup"><span data-stu-id="c77da-124">To avoid this, you need to drop down to the lower level metadata API and set the `AfterSaveBehavior` (as shown above).</span></span>

> [!NOTE]  
> <span data-ttu-id="c77da-125">**在 EF 核心 2.0 中的變更：**在舊版本中則包含儲存行為透過控制`IsReadOnlyAfterSave`旗標。</span><span class="sxs-lookup"><span data-stu-id="c77da-125">**Changes in EF Core 2.0:** In previous releases the after-save behavior was controlled through the `IsReadOnlyAfterSave` flag.</span></span> <span data-ttu-id="c77da-126">這個旗標已經認定為過時並取代`AfterSaveBehavior`。</span><span class="sxs-lookup"><span data-stu-id="c77da-126">This flag has been obsoleted and replaced by `AfterSaveBehavior`.</span></span>

<span data-ttu-id="c77da-127">也沒有觸發程序在資料庫中產生的值對`LastPayRaise`期間的資料行`UPDATE`作業。</span><span class="sxs-lookup"><span data-stu-id="c77da-127">There is also a trigger in the database to generate values for the `LastPayRaise` column during `UPDATE` operations.</span></span>

[!code-sql[Main](../../../samples/core/Saving/Saving/ExplicitValuesGenerateProperties/employee_UPDATE.sql)]

<span data-ttu-id="c77da-128">下列程式碼會增加資料庫中的兩個員工的薪資。</span><span class="sxs-lookup"><span data-stu-id="c77da-128">The following code increases the salary of two employees in the database.</span></span>
* <span data-ttu-id="c77da-129">第一個，指定任何值給`Employee.LastPayRaise`屬性，因此它會維持設定為 null。</span><span class="sxs-lookup"><span data-stu-id="c77da-129">For the first, no value is assigned to `Employee.LastPayRaise` property, so it remains set to null.</span></span>
* <span data-ttu-id="c77da-130">秒，我們設定一週前 （目付款後引發） 明確的值。</span><span class="sxs-lookup"><span data-stu-id="c77da-130">For the second, we have set an explicit value of one week ago (back dating the pay raise).</span></span>

[!code-csharp[Main](../../../samples/core/Saving/Saving/ExplicitValuesGenerateProperties/Sample.cs#LastPayRaise)]

<span data-ttu-id="c77da-131">輸出顯示資料庫產生值的第一位員工，並使用第二個我們明確的值。</span><span class="sxs-lookup"><span data-stu-id="c77da-131">Output shows that the database generated a value for the first employee and our explicit value was used for the second.</span></span>

``` Console
1: John Doe, 1/26/2017 12:00:00 AM
2: Jane Doe, 1/19/2017 12:00:00 AM
```
